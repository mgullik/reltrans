main = main_simple_call.f90
# main_relt = main_test.f90
# main_relt = main_fits_jingyi.f90
# main_relt = main_fits_jingyi_finalized.f90
# main_reflionx = main_test_reflionx.f90
# main_lag_freq = main_test_lag_vs_freq.f90

#lib and other stuff to include to the compiler 
incs = -I /usr/local/Cellar/fftw/3.3.8_2/include/ -ffree-line-length-none
libs = -L /usr/local/Cellar/fftw/3.3.8_2/lib/ -lfftw3_omp -lfftw3 -lm \
       -L/Users/gullo/Software/heasoft-6.28/x86_64-apple-darwin18.7.0/lib/ \
       -lXSFunctions -lcfitsio -lXSModel -lXSUtil -lXS
       #-lwcs-5.16 -lCCfits_2.5 -lhdsp_2.9 -ltcl8.6 

optimization = -O3
debug        = -Wall -pedantic

# set compilers
fcomp = gfortran $(optimization) #$(debug) 
ccomp = gcc      $(optimization) 

# the files to compile 
FCODE = $(main) srevtrans.f90
FCODE_RELT = $(main_relt) srevtrans.f90
FCODE_REFL = $(main_reflionx) srevtrans.f90
CCODE = relmodels.c rellp.c relbase.c reltable.c relutility.c donthcomp.c xilltable.c relcache.c

mod:
	$(fcomp) $(incs) $(libs) -c amodules.f90
fobj: $(FCODE)
	$(fcomp) -c $(FCODE)
fobj_relt: $(FCODE_RELT)
	$(fcomp) -c $(FCODE_RELT)
fobj_refl: $(FCODE_REFL)
	$(fcomp) -c $(FCODE_REFL)
cobj: 
	$(ccomp) -c $(CCODE)

compile: mod fobj cobj
	 $(fcomp) -fno-second-underscore -fno-automatic -fPIC $(incs) $(libs) *.o -o   simple
compile_reltrans: mod fobj_relt cobj
	 $(fcomp) -fno-second-underscore -fno-automatic -fPIC $(incs) $(libs) *.o -o   reltrans_jingyi #reltrans
compile_reflionx: mod fobj_refl cobj
	 $(fcomp) -fno-second-underscore -fno-automatic -fPIC $(incs) $(libs) *.o -o reltransx

simple: clean compile cleanup
run: clean compile_reltrans cleanup
reflionx: clean compile_reflionx cleanup


clean:
	rm -vf *.o *.mod *~ subroutines/*~
cleanup:
	rm -vf *.o *.mod *~ subroutines/*~
